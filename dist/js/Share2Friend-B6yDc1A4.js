import{c as _,as as N,g as m,aw as B,ax as x,C as p,ay as b,_ as S}from"./common-eO_hgNLl.js";import{u as C,s as F}from"./other-CKGx8mSk.js";import"./vendor-BMWdzOBB.js";const T=""+new URL("../assets/water-Cq3Nzf11.png",import.meta.url).href,K={class:"Share2Friend"},D={class:"search"},w={key:0,class:"search-select-friends"},O={class:"wrapper"},I=["src","onClick"],U={key:1,class:"search-icon",src:B,alt:""},L={key:0,class:"list"},R=["onClick"],Y=["src"],$={class:"desc"},q={class:"name"},z={key:0},H={style:{color:"#ffd800"}},M={key:1},j={key:0,class:"account"},A={key:0},G={style:{color:"#ffd800"}},J={key:1},P={key:1,class:"no-result"},Q={class:"list"},W=["onClick"],X=["src"],Z=["onClick"],ee=["src"],te=["onClick"],ae=["src"],le={key:0,class:"share2friend"},ne={class:"wrapper"},se={key:0,class:"create-chat"},oe=Vue.defineComponent({name:"Share2Friend",__name:"Share2Friend",setup(ce){const v=C(),e=Vue.reactive({isCreateChat:!1,searchKey:"",indexOffsetTop:{},currentFixedIndicator:"",currentFixedIndicatorTop:"0px",friends:{all:{},recent:[],eachOther:[]},selectFriends:[],friendsSort:{},searchResult:[]});Vue.onMounted(()=>{y(),document.querySelectorAll(".index").forEach(r=>{e.indexOffsetTop[r.children[0].innerText]=r.offsetTop});let t=document.querySelectorAll(".item"),d=document.querySelector(".item:nth-child(2)").clientHeight,s=document.querySelector(".indicator"),a=s.offsetTop,o="rgb(143, 143, 158)";s.addEventListener("touchstart",r=>{let i=(r.touches[0].pageY-a)/d;i=Math.floor(i),n(i),e.currentFixedIndicatorTop=r.touches[0].pageY-28+"px"}),s.addEventListener("touchmove",r=>{let u=r.touches[0].pageY-a;e.currentFixedIndicatorTop=r.touches[0].pageY-28+"px";let i=u/d;i=Math.floor(i),i>=0&&i<27&&n(i)}),s.addEventListener("touchend",()=>e.currentFixedIndicator="");let n=r=>{t.forEach(u=>{u.style.color=o}),t[r].style.color="#fff",e.currentFixedIndicator=t[r].innerText,g(t[r])}}),Vue.watch(()=>e.searchKey,l=>{let t=_(e.friends.all);t.map(c=>{e.selectFriends.find(d=>d.id===c.id)&&(c.select=!0)}),e.searchResult=t.filter(c=>c.name.includes(l)||c.account.includes(l))});function h(l){V(l),e.searchKey=""}function k(){console.log("clear"),e.searchKey=""}function V(l){for(let s=0;s<e.friends.recent.length;s++){let a=e.friends.recent[s];if(a.name===l.name){a.select=!a.select;break}}for(let s=0;s<e.friends.eachOther.length;s++){let a=e.friends.eachOther[s];if(a.name===l.name){a.select=!a.select;break}}let t=!1,c=Object.keys(e.friendsSort);for(let s=0;s<c.length;s++){let a=c[s];for(let o=0;o<e.friendsSort[a].length;o++){let n=e.friendsSort[a][o];if(n.name===l.name){n.select=!n.select,t=!0;break}}if(t)break}let d=e.selectFriends.findIndex(s=>s.name===l.name);d!==-1?(l.select=!1,e.selectFriends.splice(d,1)):(l.select=!0,e.selectFriends.push(l))}async function y(){let l=await N();console.log("getFriends",l),l.success&&(e.friends=l.data,e.friends.all=e.friends.all.sort((t,c)=>t.pinyin<c.pinyin?-1:t.pinyin>c.pinyin?1:0),e.friends.all.map(t=>{e.friendsSort[t.pinyin]?e.friendsSort[t.pinyin].push(t):e.friendsSort[t.pinyin]=[t]}))}const f=Vue.ref();function g(l){let t;l.dataset.index?t="top":t=l.innerText,document.querySelector(`.${t}`)&&(f.value.scrollTop=document.querySelector(`.${t}`).offsetTop-100)}function E(l){let t=l.target.scrollTop+110,c=null;for(const d in e.indexOffsetTop)e.indexOffsetTop[d]<t&&(c=d);e.currentFixedIndicator=c}return(l,t)=>{const c=Vue.resolveComponent("BaseHeader"),d=Vue.resolveComponent("dy-back"),s=Vue.resolveComponent("dy-button");return Vue.openBlock(),Vue.createElementBlock("div",K,[Vue.createVNode(c,{backImg:"close",style:{"z-index":"7"}},{center:Vue.withCtx(()=>[...t[3]||(t[3]=[Vue.createElementVNode("span",{class:"f16"},"私信给",-1)])]),bottom:Vue.withCtx(()=>[Vue.createElementVNode("div",D,[e.selectFriends.length?(Vue.openBlock(),Vue.createElementBlock("div",w,[Vue.createElementVNode("div",O,[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(e.selectFriends,(a,o)=>(Vue.openBlock(),Vue.createElementBlock("img",{src:Vue.unref(m)(a.avatar),key:o,onClick:n=>V(a)},null,8,I))),128))])])):(Vue.openBlock(),Vue.createElementBlock("img",U)),Vue.withDirectives(Vue.createElementVNode("input",{type:"text",placeholder:"搜索","onUpdate:modelValue":t[0]||(t[0]=a=>e.searchKey=a)},null,512),[[Vue.vModelText,e.searchKey]]),e.searchKey?(Vue.openBlock(),Vue.createElementBlock("img",{key:2,onClick:k,class:"clear",src:x})):Vue.createCommentVNode("",!0)])]),_:1}),Vue.withDirectives(Vue.createElementVNode("div",{class:"is-search",style:Vue.normalizeStyle({height:e.selectFriends.length&&e.searchResult.length?"calc(100% - 272rem)":"calc(100% - 112rem)"})},[e.searchResult.length?(Vue.openBlock(),Vue.createElementBlock("div",L,[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(e.searchResult,(a,o)=>(Vue.openBlock(),Vue.createElementBlock("div",{class:"local-row",key:o,onClick:n=>h(a)},[Vue.createVNode(p,{mode:"red",modelValue:a.select,"onUpdate:modelValue":n=>a.select=n},null,8,["modelValue","onUpdate:modelValue"]),Vue.createElementVNode("img",{src:Vue.unref(m)(a.avatar),alt:""},null,8,Y),Vue.createElementVNode("div",$,[Vue.createElementVNode("span",q,[a.name.indexOf(e.searchKey)>-1?(Vue.openBlock(),Vue.createElementBlock("span",z,[Vue.createTextVNode(Vue.toDisplayString(a.name.substr(0,a.name.indexOf(e.searchKey))),1),Vue.createElementVNode("span",H,Vue.toDisplayString(e.searchKey),1),Vue.createTextVNode(Vue.toDisplayString(a.name.substr(a.name.indexOf(e.searchKey)+e.searchKey.length)),1)])):(Vue.openBlock(),Vue.createElementBlock("span",M,Vue.toDisplayString(a.name),1))]),a.account?(Vue.openBlock(),Vue.createElementBlock("span",j,[t[4]||(t[4]=Vue.createTextVNode(" 抖音号： ",-1)),a.account.indexOf(e.searchKey)>-1?(Vue.openBlock(),Vue.createElementBlock("span",A,[Vue.createTextVNode(Vue.toDisplayString(a.account.substr(0,a.account.indexOf(e.searchKey))),1),Vue.createElementVNode("span",G,Vue.toDisplayString(e.searchKey),1),Vue.createTextVNode(Vue.toDisplayString(a.account.substr(a.account.indexOf(e.searchKey)+e.searchKey.length)),1)])):(Vue.openBlock(),Vue.createElementBlock("span",J,Vue.toDisplayString(a.account),1))])):Vue.createCommentVNode("",!0)])],8,R))),128))])):(Vue.openBlock(),Vue.createElementBlock("div",P,[...t[5]||(t[5]=[Vue.createElementVNode("img",{src:F,alt:""},null,-1),Vue.createElementVNode("span",{class:"n1"},"搜索结果为空",-1),Vue.createElementVNode("span",{class:"n2"},"没有搜索到相关的联系人",-1)])]))],4),[[Vue.vShow,e.searchKey]]),Vue.createElementVNode("div",{ref_key:"list",ref:f,style:Vue.normalizeStyle({paddingBottom:e.selectFriends.length?"160rem":0}),class:"content",onScroll:E},[Vue.createElementVNode("div",Q,[Vue.createElementVNode("div",{class:"row",onClick:t[1]||(t[1]=a=>Vue.unref(v)("/message/joined-group-chat"))},[t[6]||(t[6]=Vue.createElementVNode("span",null,"已加入的群聊",-1)),Vue.createVNode(d,{scale:.7,direction:"right"})]),t[7]||(t[7]=Vue.createElementVNode("div",{class:"title"},"最近聊天",-1)),(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(e.friends.recent,(a,o)=>(Vue.openBlock(),Vue.createElementBlock("div",{class:"local-row",key:o,onClick:n=>V(a)},[Vue.createVNode(p,{mode:"red",modelValue:a.select,"onUpdate:modelValue":n=>a.select=n},null,8,["modelValue","onUpdate:modelValue"]),Vue.createElementVNode("img",{src:Vue.unref(m)(a.avatar),alt:""},null,8,X),Vue.createElementVNode("span",null,Vue.toDisplayString(a.name),1)],8,W))),128)),t[8]||(t[8]=Vue.createElementVNode("div",{class:"title"},"互关好友",-1)),(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(e.friends.eachOther,(a,o)=>(Vue.openBlock(),Vue.createElementBlock("div",{class:"local-row",key:o,onClick:n=>V(a)},[Vue.createVNode(p,{mode:"red",modelValue:a.select,"onUpdate:modelValue":n=>a.select=n},null,8,["modelValue","onUpdate:modelValue"]),Vue.createElementVNode("img",{src:Vue.unref(m)(a.avatar),alt:""},null,8,ee),Vue.createElementVNode("span",null,Vue.toDisplayString(a.name),1)],8,Z))),128)),t[9]||(t[9]=Vue.createElementVNode("div",{class:"title"},"全部",-1)),(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(e.friendsSort,(a,o)=>(Vue.openBlock(),Vue.createElementBlock("div",{key:o},[Vue.createElementVNode("div",{class:Vue.normalizeClass([o==="#"?"top":o,"title"])},[Vue.createElementVNode("span",null,Vue.toDisplayString(o),1)],2),(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(a,(n,r)=>(Vue.openBlock(),Vue.createElementBlock("div",{class:"local-row",key:r,onClick:u=>V(n)},[Vue.createVNode(p,{mode:"red",modelValue:n.select,"onUpdate:modelValue":u=>n.select=u},null,8,["modelValue","onUpdate:modelValue"]),Vue.createElementVNode("img",{src:Vue.unref(m)(n.avatar),alt:""},null,8,ae),Vue.createElementVNode("span",null,Vue.toDisplayString(n.name),1)],8,te))),128))]))),128))]),e.selectFriends.length&&e.searchResult.length?(Vue.openBlock(),Vue.createElementBlock("div",le,[t[11]||(t[11]=Vue.createElementVNode("div",{class:"comment"},[Vue.createElementVNode("textarea",{placeholder:"有什么想和好友说的..."}),Vue.createElementVNode("img",{class:"poster",src:b,alt:""})],-1)),Vue.createElementVNode("div",ne,[e.selectFriends.length>1?(Vue.openBlock(),Vue.createElementBlock("div",se,[Vue.createVNode(p,{mode:"red",modelValue:e.isCreateChat,"onUpdate:modelValue":t[2]||(t[2]=a=>e.isCreateChat=a)},null,8,["modelValue"]),t[10]||(t[10]=Vue.createElementVNode("span",null,"创建群聊",-1))])):Vue.createCommentVNode("",!0),Vue.createVNode(s,{type:"primary"},{default:Vue.withCtx(()=>[Vue.createTextVNode(Vue.toDisplayString(e.selectFriends.length>1?"分别发送":"发送"),1)]),_:1})])])):Vue.createCommentVNode("",!0)],36),t[13]||(t[13]=Vue.createStaticVNode('<div class="indicator-ctn" data-v-0bc4a0af><div class="indicator" data-v-0bc4a0af><div class="item" data-index="top" data-v-0bc4a0af>#</div><div class="item" data-v-0bc4a0af>A</div><div class="item" data-v-0bc4a0af>B</div><div class="item" data-v-0bc4a0af>C</div><div class="item" data-v-0bc4a0af>D</div><div class="item" data-v-0bc4a0af>E</div><div class="item" data-v-0bc4a0af>F</div><div class="item" data-v-0bc4a0af>G</div><div class="item" data-v-0bc4a0af>H</div><div class="item" data-v-0bc4a0af>I</div><div class="item" data-v-0bc4a0af>J</div><div class="item" data-v-0bc4a0af>K</div><div class="item" data-v-0bc4a0af>L</div><div class="item" data-v-0bc4a0af>M</div><div class="item" data-v-0bc4a0af>N</div><div class="item" data-v-0bc4a0af>O</div><div class="item" data-v-0bc4a0af>P</div><div class="item" data-v-0bc4a0af>Q</div><div class="item" data-v-0bc4a0af>R</div><div class="item" data-v-0bc4a0af>S</div><div class="item" data-v-0bc4a0af>T</div><div class="item" data-v-0bc4a0af>U</div><div class="item" data-v-0bc4a0af>V</div><div class="item" data-v-0bc4a0af>W</div><div class="item" data-v-0bc4a0af>X</div><div class="item" data-v-0bc4a0af>Y</div><div class="item" data-v-0bc4a0af>Z</div></div></div>',1)),e.currentFixedIndicator?(Vue.openBlock(),Vue.createElementBlock("div",{key:0,class:"hover",style:Vue.normalizeStyle({top:e.currentFixedIndicatorTop}),ref:"hover"},[t[12]||(t[12]=Vue.createElementVNode("img",{src:T,alt:""},null,-1)),Vue.createElementVNode("span",null,Vue.toDisplayString(e.currentFixedIndicator),1)],4)):Vue.createCommentVNode("",!0)])}}}),ue=S(oe,[["__scopeId","data-v-0bc4a0af"]]);export{ue as default};
